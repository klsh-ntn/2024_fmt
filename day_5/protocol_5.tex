% arara: xelatex
\documentclass[12pt]{article}
\usepackage{libertine}

% TODO: почему-то первая страница пустая при компиляции в xelatex, ну и ладушки

% если не менять дизайн, то поправить надо только 
% \newcommand{\tour}{...}
% и 
% \newcommand{\blockofjudges}{...}

\newcommand{\tour}{ФМТ тур 5} % номер тура

% \newcommand{\blockofjudges}{
% table x
% \protocol{where}{team-a}{team-b}{top judge}{more judges} % comment
% }


% клш-47(2024) доступные локации: 1.1, 1.2, 2.1, 2.2, 3.1, 3.2, вк, Гарвард, Кэмбридж, Сорбонна, столовая
% 22 команды, 11 судейских бригад

% Направление точных наук - 2024

% Адо Ваня, фо, альфа
% Гулицкий Коля, фо, ещё не приехал
% Демешев Боря, мо
% Карлов Ваня, мо, ро, уехал с третьего тура
% Красков Михаил, фо, тета
% Ламзин Серёжа, фо, омикрон
% Лисин Роман, фо, сигма
% Луковская Вика, мо, иногда нельзя ставить
% Майдуров Артем, мо, гамма
% Моисеева Лиза, мо, тау
% Скурковин Егор, фо, пи
% Смирнова Полина, фо, пси
% Снегур Даниил, фо, каппа
% Спрыжков Тима, фо, ню
% Тимошков Саша, мо, тау
% Федянов Максим, фо, эпсилон
% Шапиро Ян, мо, ро
% Шарковская Антонина, мо, йота 
% Шейкин Антон, фо
% Шестаков Вячеслав, фо, пси


% Гринштейн Роберт, фн, омега
% Кабриц Всеволод, мн, лямбда
% Комарова Марина Владимировна, фн, уехала с третьего тура
% Маньков Андрей, мн, уехал с третьего тура
% Михеева Вера, фн, каппа
% Рябенко Павел, фн, ро
% Сидельников Влад, фн, мю
% Сырбачев Александр, мн, приехал с третьего тура

% зондера нтн 2024
% Зелинский Витя, мн, сигма
% Лунёв Егор, мн, тау
% Судницына Настя, мн, эта
% Тимофеев Вова, мн, дельта
% Трегубович Андрей, мн, лямбда
% Фёдоров Вова, фн, хи
% Хмельницкая Марина, фн, альфа

% вольные стрелки с нен
% Аршукова Ира, фо
% Юля Безгачева, фо, отсутствует

% пожелалки:
% пси не ставить с Антоном Шейкиным
% Тима Спрыжков — стол повыше
% Рома Лисин — стол повыше
% тур 3: без Иры Аршуковой, без Лизы Моисеевой



\newcommand{\blockofjudges}{ %
% day 1
% table 1
\protocol{1.1}{$\gamma$}{$\omega$}{Рома Лисин}{Витя Зелинский, Макс Федянов} %
%
% table 2
\protocol{1.2}{$\sigma$}{$\psi$}{Тима Спрыжков}{Роберт Гринштейн, Лиза Моисеева}  % 
%
% table 3
\protocol{2.1}{$\phi$}{$\alpha$}{Коля Гулицкий}{Ян Шапиро, Вера Михеева} %  
%
% table 4
\protocol{2.2}{$\theta$}{$\xi$}{Антон Шейкин}{Марина Хмельницкая, Егор Лунёв} % 
%
% table 5
\protocol{3.1}{$\pi$}{$\rho$}{Даня Снегур}{Влад Сидельников, Серёжа Ламзин} % 
%
% table 6
\protocol{3.2}{$\mu$}{$\kappa$}{Ваня Адо}{Андрей Трегубович, Саша Тимошков} %
%
% table 7
\protocol{вк}{$\chi$}{$\varepsilon$}{Егор Скурковин}{Настя Судницына, Вова Тимофеев} %  
%
% table 8
\protocol{Гарвард}{$\delta$}{$\eta$}{Майдуров Артём}{Антонина Шарковская, Вова Фёдоров} % 
%
% table 9 
\protocol{Кэмбридж}{$\nu$}{$\beta$}{Слава Шестаков}{Всеволод Кабриц, Михаил Красков} % 
%
% table 10
\protocol{Сорбонна}{$\lambda$}{$o$}{Полина Смирнова}{Павел Рябенко} % 
%
% table 11
\protocol{БХ}{$\tau$}{$\iota$}{Вика Луковская}{Боря Демешев} % 
}


\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{graphicx}
\usepackage{rotating}
\usepackage{makecell}
\usepackage{array}
\usepackage{tikzsymbols}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}


\usepackage{fontspec} % поддержка разных шрифтов
\usepackage{polyglossia} % поддержка разных языков

\setmainlanguage{russian}
\setotherlanguages{english}

\usepackage[top=0.5cm, left=0.5cm, right=1cm, bottom=1cm]{geometry} % размер текста на странице
\pagestyle{empty}

\usepackage{booktabs}
% заповеди из документации:
% 1. Не используй вертикальные линии
% 2. Не используй двойные линии
% 3. Единицы измерения помещай в шапку таблицы
% 4. Не сокращай .1 вместо 0.1
% 5. Повторяющееся значение повторяй, не пиши "то же"

\newcommand{\myrotcell}[1]{\rotcell{\makebox[0pt][l]{#1}}}


\newcommand{\protocol}[5]{ %
\begin{minipage}{.2\textwidth}
    \begin{center}
    \includegraphics[width=0.48\textwidth]{klshlogo.pdf}
    \end{center}
\end{minipage}
\begin{minipage}{.6\textwidth}
    \begin{flushleft}
    \textbf{Старший судья}: #4\\ 
    \textbf{Судьи}: #5 \\ 
    \textbf{Аудитория}: #1 \\ 
    \end{flushleft}
\end{minipage}
\begin{minipage}{.2\textwidth}
    \begin{flushleft}
        {\Large\textbf{\tour}} \\
        \textbf{Команды}: #2 — #3 
    \end{flushleft}
\end{minipage}

\vspace*{0.2cm}
\begin{tabular}{ | M{0.4cm} | M{2cm} | M{6.1cm} | M{0.8cm} | M{0.8cm} | M{0.5cm} | M{6.1cm} |}
    \hline
    \Smiley[1.6] & Время & Ответ и игрок #2 & балл #2 & балл #3 & \tiny{ $\times$ $\leftarrow$ $\rightarrow$} & Ответ и игрок #3 \\
    \hline
    \rotatebox{90}{Задача 1\hspace*{1cm}} & & & & & & \\ [2.1cm]
    \hline
    \rotatebox{90}{Задача 2\hspace*{1cm}} & & & & & & \\ [2.1cm]
    \hline
    \rotatebox{90}{Задача 3\hspace*{1cm}} & & & & & & \\ [2.1cm]
    \hline
    \rotatebox{90}{Задача 4\hspace*{1cm}} & & & & & & \\ [2.1cm]
    \hline
\end{tabular}

\vspace*{0.25cm} 

\begin{minipage}{.42\textwidth}

%Условные значки: \\
$\times$ задача снята \\
$\rightarrow$ переход от #2 к #3 \\
$\leftarrow$ переход от #3 к #2 \\

\begin{tabular}{ | m{5cm} | M{1cm} | M{1cm} |}
\hline
\textbf{} & #2 & #3 \\
\hline
Вольные стрелки & & \\ [0.8cm]
\hline
Итог основного этапа & & \\ [0.8cm]
\hline 
\end{tabular}

\vspace*{1cm}
\textbf{Подписи команд:}\dotfill\\

\vspace*{0.5cm}
\textbf{Подписи судей:}\dotfill\\
\end{minipage}
\hspace*{0.5cm}
\begin{minipage}{.55\textwidth}
\begin{tabular}{ | m{5cm} | M{2.3cm} | M{2.3cm} |}
\hline
\textbf{Этап обмена ударами} & #2 & #3 \\
\hline 
\vspace*{0.4cm}Решение задачи соперника\vspace*{1cm} Докладчик & & \\ [1.6cm]
\hline
Штраф за незнание & & \\ [0.6cm]
\hline
Дисциплинарный штраф & & \\ [0.6cm]
\hline
Красота обменной задачи & & \\ [0.6cm]
\hline
\textbf{Итоговый счёт} & & \\ [0.6cm]
\hline
\end{tabular}
\end{minipage}
\newpage
}


\setlength\parindent{0pt}

\begin{document}
\blockofjudges

\renewcommand{\protocol}[5]{
    #2 — #3 & #1 \\ 
    \hline 
}


\begin{center}
   \textbf{ 
    {\Huge \tour \\
    \vspace{3cm}
    \begin{tabular}{| M{6cm} | M{6cm} |}
    \hline
    Команды & Аудитория\\ 
    \hline
    \blockofjudges
    \end{tabular}
    }
   }
\end{center}

\newpage
\renewcommand{\protocol}[5]{
    #2 — #3 & #1 & #4, #5\\ 
    \hline 
}


\begin{center}
   \textbf{ 
    {\Huge \tour} \\
    {\Large
    \vspace{3cm}
    \begin{tabular}{| c | c | M{10cm}|}
    \hline
    Команды & Аудитория\\ 
    \hline
    \blockofjudges
    \end{tabular}
    }
   }
\end{center}


\end{document}
